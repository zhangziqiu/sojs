!function(){var e={name:"sojs",namespace:"",classes:{},classesCache:{},path:{},pathCache:{},loadErrorInfo:{},noop:function(){},$sojs:function(){var e={};if("undefined"!=typeof window&&window&&"undefined"!=typeof document&&document?(this.runtime="browser",e.global=window):(this.runtime="node",e.global=global),e.proxyName="proxy",e.path="node"===this.runtime?process.cwd()+"/src/":"/src/","undefined"!=typeof $sojs_config)for(var t in $sojs_config)t&&$sojs_config.hasOwnProperty(t)&&(e[t]=$sojs_config[t]);this.global=e.global,e.proxyName&&(Function.prototype[e.proxyName]=this.proxy),this.setPath(e.path),this.deepClone=this.deepClone.proxy(this),this.global.sojs=this.global.sojs||this},getPath:function(e){var t=!!e&&e.split("."),s=this.path;if(t)for(var r=0,a=t.length;r<a;r++){var i=t[r].toLowerCase();if(!s[i])break;s=s[i]}return s.pathValue},setPath:function(e,t){var s=this.path;if("object"!=typeof e){if(t)for(var r=e.split("."),a=0,i=r.length;a<i;a++){var n=r[a].toLowerCase();s[n]=s[n]||{pathValue:s.pathValue},s=s[n]}else t=e;s.pathValue=t,this.pathCache={}}else for(var o in e)o&&e.hasOwnProperty(o)&&this.setPath(o,e[o])},getClassPath:function(e,t){var s=this.pathCache[e];if(!s){var r=this.getPath(e),a=r.length-1;r.lastIndexOf("\\")!==a&&r.lastIndexOf("/")!==a&&(r+="/"),s=r+e.replace(/\./gi,"/")+".js",this.pathCache[e]=s}return t&&(s=s.replace(".js","")),s},loadDeps:function(e,t){t=t||{};var s=e.__deps,r=(e.__namespace,[]);for(var a in s)if(s.hasOwnProperty(a)&&s[a]){var i;if("string"!=typeof s[a]?(e[a]=s[a],e[a]&&e[a].__name&&(i=e[a].__full)):(i=s[a],e[a]=this.find(i)),!i||t[i])continue;if(t[i]=!0,e[a])e[a].__deps&&(r=r.concat(this.loadDeps(e[a],t)));else{if("node"===this.runtime)try{e[a]=require(this.getClassPath(i))}catch(e){this.loadErrorInfo[i]=e.stack.toString()}e[a]||r.push(i)}}return r},fastClone:function(e){var t=function(){};return t.prototype=e,new t},deepClone:function(e,t){"number"!=typeof t&&(t=5);var s,r=t-1;if(t>0)if(e instanceof Date)s=new Date,s.setTime(e.getTime());else if(e instanceof Array){s=[];for(var a=0,i=e.length;a<i;a++)s[a]=this.deepClone(e[a],r)}else if("object"==typeof e){s={};for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];s[n]=this.deepClone(o,r)}}else s=e;else s=e;return s},proxy:function(e,t){var s=Array.prototype.slice.apply(arguments),r=s.shift(),a="function"==typeof this?this:s.shift();return function(){var e=Array.prototype.slice.apply(arguments);return a.apply(r,e.concat(s))}},find:function(e){var t=this.classesCache[e];if(!t){var s=e.split(".");t=this.classes[s[0]];for(var r=1,a=s.length;r<a;r++){if(!t||!t[s[r]]){t=null;break}t=t[s[r]]}}return t},reload:function(e){var t=this.find(e);if(t)if(t.__status=2,"node"===this.runtime){var s=this.getClassPath(e);delete require.cache[require.resolve(s)],t=require(s)}else t=this.define(t);else t=this.using(e);return t},create:function(e,t,s,r,a,i){return"string"==typeof e&&(e=this.using(e)),new e.__constructor(t,s,r,a,i)},using:function(e){var t=this.find(e);if("node"===this.runtime){if(t){if(!t.__status||1===t.__status)try{require(this.getClassPath(e))}catch(e){t.__status=2}}else try{require(this.getClassPath(e))}catch(e){throw e}t=this.find(e)}return t},define:function(e){var t,s=e.namespace;if("node"===this.runtime&&(void 0===e.name||void 0===e.namespace)){var r=arguments.callee.caller.arguments[4],a=arguments.callee.caller.arguments[3];!e.name&&r&&a&&(e.name=a.substring(r.length+1,a.length-3)),!e.namespace&&r&&(e.namespace=r.substring(r.indexOf("src")+4).replace(/\//gi,".").replace(/\\/gi,"."))}t=e.name||"__tempName",s=e.namespace||"",e.__name=t,e.__namespace=s,e.__full=s.length>1?s+"."+t:t,e.__deps=e.deps,e.__deepClone=this.deepClone,e.__status=2,e.__constructor=function(e,t,s,r,a){if(this.__clones&&this.__clones.length>0)for(var i=0,n=this.__clones.length;i<n;i++){var o=this.__clones[i];this[o]=this.__deepClone(this[o])}this.__constructorSource(e,t,s,r,a)},e.__constructorSource=e[t]||this.noop,e.__staticSource=e["$"+t]||this.noop,e.__staticUpdate=function(){var t=[];for(var s in this)if(this.hasOwnProperty(s)){var r=this[s];"object"!=typeof r||null===r||"deps"===s||0===s.indexOf("__")||e.__deps&&e.__deps[s]||t.push(s)}this.__clones=t,this.__constructor.prototype=this},e.__static=function(){this.__staticSource(),this.__staticUpdate()};for(var i,n=s.split("."),o=n.length,h=this.classes,l=0;l<o;l++)(i=n[l])&&(h[i]=h[i]||{__status:1},h=h[i]);h[t]=h[t]||{};var c=h;if(h=h[t],!h.__name||3!==h.__status){if(!h.__status||1===h.__status)for(var f in c[t])f&&c[t].hasOwnProperty(f)&&(e[f]=c[t][f]);e.__status=3,c[t]=e,e=c[t];var p=this.loadDeps(e);if(p.length>0){if(this.loader=this.loader||this.using("sojs.loader"),"browser"!==this.runtime||!this.loader){for(var u='class "'+e.name+'" load deps error\n',l=0;l<p.length;l++)u+="["+p[l]+"]:"+this.loadErrorInfo[p[l]]+"\n";throw new Error(u)}this.loader.loadDepsBrowser(e,p)}else e.__static()}return"node"===this.runtime&&arguments.callee.caller.arguments[2]&&(arguments.callee.caller.arguments[2].exports=e),this.classesCache[e.___full]=e,e}};e.define(e)}();